<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8">
  <title>JapQuiz</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 30px;
      background-color: #f5f5f5;
      color: #333;
    }
    h1, h2, h3 {
      text-align: center;
    }
    button {
      display: block;
      margin: 10px auto;
      padding: 10px 20px;
      font-size: 16px;
    }
    .quiz-card {
      max-width: 600px;
      margin: 20px auto;
      padding: 20px;
      background: white;
      border-radius: 8px;
      box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    }
    .options button {
      width: 100%;
      margin: 5px 0;
      text-align: left;
    }
    #paroleSidebar {
      margin-top: 20px;
      padding-left: 20px;
    }
    .blur {
      font-weight: bold;
    }
  </style>
</head>
<body>

  <div style="text-align: center;">
    <span id="lang-it" onclick="setLanguage('it')" style="cursor:pointer; margin-right: 6px;">Italiano</span> |
    <span id="lang-en" onclick="setLanguage('en')" style="cursor:pointer; margin-left: 6px;">Inglese</span>
  </div>

  <h1 id="titolo">Quiz di Romaji Giapponese</h1>

  <button id="start-btn" onclick="startQuiz()">Inizia il quiz</button>

  <h2 id="istruzioni">Seleziona la risposta corretta:</h2>

  <div class="quiz-card" id="quiz-container"></div>

  <h3 id="sidebar-titolo">Parole Imparate</h3>
  <ul id="paroleSidebar"></ul>

  <script src="new_romaji_quiz_data.js"></script>

  <script>
    let currentLang = 'it';
    let currentQuestionIndex = 0;
    let shuffled = [];

    const traduzioniUI = {
      titolo: {
        it: "Quiz di Romaji Giapponese",
        en: "Japanese Romaji Quiz"
      },
      startBtn: {
        it: "Inizia il quiz",
        en: "Start the quiz"
      },
      istruzioni: {
        it: "Seleziona la risposta corretta:",
        en: "Choose the correct answer:"
      },
      sidebarTitolo: {
        it: "Parole Imparate",
        en: "Learned Words"
      }
    };

    function setLanguage(lang) {
      currentLang = lang;
      document.getElementById("lang-it").style.fontWeight = lang === 'it' ? "bold" : "normal";
      document.getElementById("lang-en").style.fontWeight = lang === 'en' ? "bold" : "normal";
      loadQuestion();
      popolaSidebar();

      document.getElementById("titolo").innerText = traduzioniUI.titolo[currentLang];
      document.getElementById("start-btn").innerText = traduzioniUI.startBtn[currentLang];
      document.getElementById("istruzioni").innerText = traduzioniUI.istruzioni[currentLang];
      document.getElementById("sidebar-titolo").innerText = traduzioniUI.sidebarTitolo[currentLang];
    }

    function popolaSidebar() {
      const sidebar = document.getElementById("paroleSidebar");
      sidebar.innerHTML = "";
      shuffled.forEach(entry => {
        const traduzione = entry[currentLang === 'it' ? "italiano" : "inglese"] || "[manca traduzione]";
        const li = document.createElement("li");
        li.innerHTML = `<span class="blur">${entry.romaji}</span> â€“ ${traduzione}`;
        sidebar.appendChild(li);
      });
    }

    function loadQuestion() {
      const container = document.getElementById("quiz-container");
      container.innerHTML = "";

      if (currentQuestionIndex >= shuffled.length) {
        container.innerHTML = `<p>${currentLang === 'it' ? "Hai completato il quiz!" : "You completed the quiz!"}</p>`;
        return;
      }

      const question = shuffled[currentQuestionIndex];
      const questionText = question.romaji;
      const options = [
        question.italiano,
        question.inglese,
        "Opzione falsa 1",
        "Opzione falsa 2"
      ].sort(() => Math.random() - 0.5);

      const frase = question.frase || "";
      const trad = question.traduzione?.[currentLang] || "";

      container.innerHTML = `
        <h3>${questionText}</h3>
        <p><em>${frase}</em></p>
        <p>${trad}</p>
        <div class="options">
          ${options.map(opt => `<button onclick="checkAnswer('${opt}', '${question[currentLang === 'it' ? 'italiano' : 'inglese']}')">${opt}</button>`).join('')}
        </div>
      `;
    }

    function checkAnswer(selected, correct) {
      if (selected === correct) {
        currentQuestionIndex++;
        loadQuestion();
      } else {
        alert(currentLang === 'it' ? "Risposta sbagliata!" : "Wrong answer!");
      }
    }

    function startQuiz() {
      shuffled = [...data].sort(() => Math.random() - 0.5);
      currentQuestionIndex = 0;
      loadQuestion();
      popolaSidebar();
    }

    setLanguage(currentLang);
  </script>

</body>
</html>
